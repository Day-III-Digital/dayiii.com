{{- define "main" }}
    {{- $pages := union .RegularPages .Sections }}
    {{- $paginator := .Paginate $pages }}
    {{- if and .IsHome site.Params.homeInfoParams (eq $paginator.PageNumber 1) }}
    {{- partial "home_info.html" . }}
    {{- end }}

    <div class="container">
        <div class="parallax-layer">{{ partial "images/scenery.svg" }}</div>
        {{ range $index, $element :=  where .Site.RegularPages "Type" "landing" }}
            <div class="row content-row">
                {{ .Content }}
            </div>
        {{ end }}
    </div>

    <style>
        html {
            scroll-behavior: smooth;
        }

        h3 {
            text-align: center;
            margin: 2rem;
            font-size: xxx-large;
        }

        .header {
            position: fixed;
            z-index: 9999;
        }

        .row {
            max-width: calc(var(--main-width) + var(--gap) * 2);
            margin: auto;
            padding: 0 var(--gap);
            position: relative;
            z-index: 1;
        }

        .main {
            max-width: unset;
        }

        .parallax-layer {
            min-height: 100vh;
            width: 100%;
            top: 0px;
            left: 0px;
            position: fixed;
        }

        .parallax-layer > svg {
            width: 100%;
            height: 100%;
        }

        :root {
            --layer-1: var(--primary);
            --layer-2: rgb(245, 250, 250);
            --layer-3: var(--theme);
            --layer-4: rgb(150, 175, 150);
        }

        .dark {
            --layer-1: var(--primary);
            --layer-2: rgb(90, 90, 90);
            --layer-3: var(--theme);
            --layer-4: rgb(50, 55, 50);
        }

    </style>

    <script>
        function parallaxScrollHandler() {
            var layers = document.getElementsByClassName('parallax-layer');
            for(var i = 0; i < layers.length; i++) {
                layers[i].style.transform = "translateY(-" + window.pageYOffset + "px)";
            }
        }

        function correctHeight() {
            var layers = document.getElementsByClassName('parallax-layer');
            var longestLayer = 0;
            for(var i = 0; i < layers.length; i++) {
                if (layers[i].clientHeight > longestLayer) {
                    longestLayer = layers[i].clientHeight;
                }
            }
            var rows = document.getElementsByClassName('content-row');
            if (rows.length > 1) {
                rows[0].style.height = Math.max(rows[0].clientHeight, longestLayer)+"px";
            }
        }

        window.addEventListener('scroll', parallaxScrollHandler);
        parallaxScrollHandler();
        correctHeight();
    </script>
{{- end }}